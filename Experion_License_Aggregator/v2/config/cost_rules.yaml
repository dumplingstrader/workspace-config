# Cost Calculation Rules

# Purpose: Define pricing cascade and calculation strategy
# Supports multiple pricing sources with priority ordering

---

# Pricing Strategy (Cascade Order)
# Higher priority sources checked first, fallback to next if not found
pricing_strategy:
  - name: "MPC 2026 Confirmed"
    source: cost_catalog_mpc_2026.json
    priority: 1
    description: "Confirmed pricing from 2026 purchase orders"
    
  - name: "Honeywell Baseline"
    source: cost_catalog.json
    priority: 2
    description: "Historical Honeywell pricing from 2021-2022 contracts"
    
  - name: "Placeholder"
    priority: 3
    value: 100.00
    description: "Default placeholder for unknown license types"

---

# Cost Calculation Rules
calculation:
  # Formula: (quantity / per) * unit_cost
  # Example: 4750 PROCESSPOINTS at $45 per 50 = (4750 / 50) * 45 = $4,275
  
  # Rounding
  round_to_cents: true  # Round to 2 decimal places
  
  # Minimum charges
  minimum_charge: 0.01  # Don't report $0.00 costs
  
  # Reporting
  include_zero_costs: false  # Exclude licenses with 0 quantity
  include_pricing_source: true  # Track which catalog provided price

---

# Cost Catalog Schema
# Expected structure in cost_catalog*.json files
catalog_schema:
  fields:
    - name: unit_cost
      type: float
      required: true
      description: "Cost per 'per' increment"
    
    - name: per
      type: int
      required: true
      description: "Quantity increment (e.g., 50 for process points)"
    
    - name: category
      type: string
      required: false
      description: "License category for reporting"
    
    - name: description
      type: string
      required: false
      description: "Human-readable description"
  
  example:
    PROCESSPOINTS:
      unit_cost: 45.00
      per: 50
      category: "Points"
      description: "Process I/O points"

---

# Validation Rules
validation:
  # Warn if unit_cost seems unreasonable
  min_unit_cost: 0.01
  max_unit_cost: 100000.00
  
  # Warn if per is unusual
  valid_per_values: [1, 5, 10, 25, 50, 100, 250, 500, 1000]
  
  # Check for required license types
  required_types:
    - PROCESSPOINTS
    - SCADAPOINTS
    - DIRECTSTATIONS
    - DUAL

---

# Reporting Options
reporting:
  # Group costs by category in summary
  summarize_by_category: true
  
  # Show breakdown by pricing source
  show_source_breakdown: true
  
  # Include line-item details
  include_line_items: true
  
  # Format options
  currency_symbol: "$"
  currency_format: "{symbol}{amount:,.2f}"
  
  # Highlight placeholder pricing
  flag_placeholder_costs: true
